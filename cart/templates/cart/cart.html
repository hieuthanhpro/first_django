{% extends "base.html" %}

{% block content %}
<div class="container mt-5">
    <h2 class="text-center mb-4">üõí Gi·ªè h√†ng c·ªßa b·∫°n</h2>

    {% if cart_items %}
    <div class="row">
        <div class="col-md-8">
            <div class="card shadow-sm">
                <div class="card-body">
                    <table class="table align-middle">
                        <thead class="table-dark">
                            <tr>
                                <th>S√°ch</th>
                                <th class="text-center">S·ªë l∆∞·ª£ng</th>
                                <th class="text-end">Gi√°</th>
                                <th class="text-end">Th√†nh ti·ªÅn</th>
                                <th class="text-center">H√†nh ƒë·ªông</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for item in cart_items %}
                            <tr>
                                <td>
                                    <strong>{{ item.book.title }}</strong><br>
                                    <small class="text-muted">T√°c gi·∫£: {{ item.book.author }}</small>
                                </td>
                                <td class="text-center">
                                    <form method="POST" action="{% url 'update_cart' item.id %}" class="d-inline">
                                        {% csrf_token %}
                                        <input type="number" name="quantity" value="{{ item.quantity }}" min="1" class="form-control text-center d-inline-block w-50">
                                        <button type="submit" class="btn btn-sm btn-primary">C·∫≠p nh·∫≠t</button>
                                    </form>
                                </td>
                                <td class="text-end">{{ item.book.price|floatformat:0 }} ‚Ç´</td>
                                <td class="text-end">{{ item.total_price }} ‚Ç´</td>
                                <td class="text-center">
                                    <a href="{% url 'remove_from_cart' item.id %}" class="btn btn-sm btn-danger">üóë X√≥a</a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- C·ªôt t·ªïng ti·ªÅn & thanh to√°n -->
        <div class="col-md-4">
            <div class="card shadow-sm">
                <div class="card-body text-center">
                    <h4 class="mb-3">üõç T·ªïng ti·ªÅn: <strong>{{ total_price|floatformat:0 }} ‚Ç´</strong></h4>
                    <a href="{% url 'checkout' %}" class="btn btn-success w-100 py-2">üõí Thanh to√°n ngay</a>
                </div>
            </div>
        </div>
    </div>

    {% else %}
    <div class="text-center">
        <p>üõí Gi·ªè h√†ng c·ªßa b·∫°n ƒëang tr·ªëng!</p>
        <a href="{% url 'book_list' %}" class="btn btn-primary">üìö Ti·∫øp t·ª•c mua s·∫Øm</a>
    </div>
    {% endif %}
</div>
{% endblock %}
